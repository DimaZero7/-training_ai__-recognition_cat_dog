# Recognition cats and dogs

Этот проект представляет собой обучающее приложение, разработанное для распознавания изображений котов и собак. Основная цель проекта — научиться работать с нейронными сетями и алгоритмами машинного обучения для классификации изображений.

В текущей реализации на 60 случайных изображениях, из которых 30 котов и 30 собак, неверно были распознаны 1 фото кота и 4 собаки, что составило 3% из общей выборки.

## Оглавление
1) [Установка](README.md#установка)
2) [Набор данных](README.md#набор-данных)
3) [Структура проекта внутри src](README.md#структура-проекта-внутри-директории-src)
4) [Запуск на GPU](README.md#запуск-на-gpu)



## Установка
[Ссылка на документациюъ](./docs/ru/index.md#установка)

## Набор данных

### Установка тренировочного набора данных

1. **Скачайте архив** с набором данных по [ссылке](https://www.microsoft.com/en-us/download/details.aspx?id=54765).

2. **Создайте папки `dataset/training`** внутри директории `src`.

3. **Перенесите папки `Cat` и `Dog`** в только что созданную папку `dataset/training`.

4. **Переименуйте папки** `Cat` и `Dog`, приведя их имена к нижнему регистру, чтобы итоговые пути выглядели следующим образом:
    - `src/dataset/training/dog`
    - `src/dataset/training/cat`
   
5. Удалите изображения cats/666.jpg и dogs/11702.jpg, так как они повреждены.

### Добавление выборки для валидации

1. **Создайте папки `dataset/validate`** в директории `src`.

2. **Создайте папки `cat` и `dog`** в только что созданной папке `dataset/validate`, чтобы итоговые пути к папкам выглядели следующим образом:
    - `src/dataset/validate/dog`
    - `src/dataset/validate/cat`

3. **Добавьте хотя бы по одному изображению в папки `dog` и `cat`**. Если оставить только одну папку заполненной, то при выполнении кода возникнет ошибка. Необходимо добавить минимум по одной фотографии в каждую папку.

4. **Запустите файл `model_run.py`**. В консоли будет выведена статистика, показывающая, какие изображения были распознаны, а какие нет.

## Структура проекта внутри директории `src`

- `dataset/training`: Папка с набором данных для обучения, содержащая изображения котов и собак. Необходимо создать.
- `dataset/validate`: Папка с набором данных для валидации, содержащая изображения для распознавания. Необходимо создать.
- `settings.py`: Файл, хранящий переменные конфигурации проекта.
- `services.py`: Файл содержит методы и классы для реализации основной логики приложения.
- `model.h5`: Обученная нейронная сеть, используемая для распознавания данных из папки `dataset/validate`. Перезаписывается после каждого запуска `model_traininging.py`.
- `traininging_testing_correlation.png`: График изменения потерь модели на тренировочных и тестовых данных. Перезаписывается после каждого запуска `model_traininging.py`.
- `model_run.py`: Запускает распознавание файлов из папки `dataset/validate` на основе модели в файле `model.h5`.
- `model_traininging.py`: Запускает обучение сети на основе данных из `dataset/training`.

## Запуск на GPU

Чтобы запустить нейросеть на GPU, необходимо выполнить следующие шаги:

1) Создать контейнер в Docker, используя следующую команду:
```bash
docker run -it --gpus all -v absolute_path/src:/app/ --name container_name tensorflow/tensorflow:latest-gpu
```

2) Войти в контейнер:
```bash
docker exec -it container_name bash
```

3) Перейти в директорию `app`:
```bash
cd app
```

4) Установить все необходимые пакеты с помощью pip:
```bash
pip install package_name
```

5) Запустить обучение или выполнение нейронной сети. Она будет выполнена на GPU.
